:root{
  --bg:#0d1117;
  --card:#161b22;
  --text:#c9d1d9;
  --muted:#8b949e;
  --border:#30363d;
  --blue:#58a6ff;
  --green:#238636;
  --yellow:#d29922;
  --gray:#6e7681;
  --red: #f85149;         /* vermelho vivo */
  --red-muted: #8b3431;   /* vermelho esmaecido */
}
*{box-sizing:border-box}
body{
  margin:0; padding:0; background-color:var(--bg); color:var(--text);
  display:flex; flex-direction:column; align-items:center; min-height:100vh;
  font-family:'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  line-height:1.5;
}

/* Top bar */
#dropdown-container{
  position:sticky; top:0; background-color:var(--bg);
  border-bottom:1px solid var(--border); z-index:1000; padding:16px;
  width:100%; max-width:100%; text-align:center;
}

/* Linha do select + botão NC */
#dropdown-container .controls{
  display: flex;
  gap: 10px;
  justify-content: center;
  align-items: center;
  flex-wrap: wrap; /* quebra em telas pequenas */
  width: 100%;
}

select#dropdown{
  background-color:#161b22; color:var(--text); border:1px solid var(--border);
  border-radius:12px; padding:10px 40px 10px 12px; font-size:14px;
  font-family:'Inter',sans-serif; transition:border-color .2s ease, background-color .2s ease, box-shadow .2s ease;
  outline:none; width:100%; max-width:600px; cursor:pointer; appearance:none;
  background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12"><path fill="%23c9d1d9" d="M6 8.5L11 3.5H1z"/></svg>');
  background-repeat:no-repeat; background-position:right 12px center; background-size:12px;
}
select#dropdown:hover{ border-color:#8b949e }
select#dropdown:focus{
  border-color:var(--blue);
  box-shadow:0 0 0 3px rgba(58,166,255,.2);
  background-color:#21262d;
}

/* Botão NC */
.btn-nc{
  background-color: var(--red-muted);
  color: #f0f6fc;
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 10px 14px;
  font-size: 14px;
  font-family: 'Inter', sans-serif;
  cursor: pointer;
  transition: transform .12s ease, background-color .15s ease, border-color .15s ease, filter .15s ease;
  line-height: 1;
}
.btn-nc:hover{ filter: brightness(1.05); }
.btn-nc:active{ transform: scale(0.98); }
/* Estado ativo (vermelho vivo) */
.btn-nc.is-active{
  background-color: var(--red);
  border-color: #aa2620;
}

/* NOVO: Botão Toggle 3D */
.btn-toggle-3d{
  background-color:#21262d;
  color:#f0f6fc;
  border:1px solid var(--border);
  border-radius:12px;
  padding:10px 14px;
  font-size:14px;
  font-family:'Inter',sans-serif;
  cursor:pointer;
  transition: transform .12s ease, background-color .15s ease, border-color .15s ease, filter .15s ease, box-shadow .15s ease;
  line-height:1;
}
.btn-toggle-3d:hover{ filter:brightness(1.05); }
.btn-toggle-3d:active{ transform:scale(0.98); }
.btn-toggle-3d.is-active{
  border-color: var(--blue);
  box-shadow:0 0 0 3px rgba(88,166,255,0.20);
}

/* SVG area */
#svg-container{ padding:24px; width:100%; flex:1 1 auto; display:flex; align-items:center; justify-content:center; overflow:hidden; }
#svg{
  background-color:#161b22; border-radius:12px; border:1px solid var(--border);
  display:block; width:100%; height:100%; max-width:100%; max-height:100%;
  box-shadow:0 1px 3px rgba(0,0,0,.1);
}
text{ font-family:'Inter',sans-serif; pointer-events:none; fill:var(--text); font-size:clamp(6px,1.2vw,12px); text-anchor:start; dominant-baseline:hanging; user-select:none; }
.cell{ cursor:pointer; transition:filter .2s ease, transform .15s ease; stroke:var(--border); stroke-width:1; rx:0; ry:0; }
.cell.disabled{ cursor:default; }
.cell:not(.disabled):hover{ filter:brightness(1.2) }
.apt-text{ pointer-events:none; font-size:clamp(5px,1vw,8px); fill:var(--text); font-weight:500; text-anchor:start; dominant-baseline:hanging; user-select:none; opacity:0; transition:opacity .2s ease; }
rect.cell.active + .apt-text,
rect.cell:hover + .apt-text{ opacity:1 }
.duracao-text{ pointer-events:none; fill:var(--text); font-weight:600; font-size:clamp(6px,1.2vw,12px); text-anchor:middle; dominant-baseline:middle; transition:opacity .2s ease; opacity:1; user-select:none; }
rect.cell.active + .apt-text + .duracao-text,
rect.cell:hover + .apt-text + .duracao-text{ opacity:0 }

/* Loading */
#loading{ position:fixed; inset:0; background-color:rgba(13,17,23,.8); display:flex; justify-content:center; align-items:center; z-index:9999; visibility:hidden; opacity:0; transition:opacity .3s ease; pointer-events:none; }
#loading.show{ visibility:visible; opacity:1; pointer-events:auto }
.spinner{ border:4px solid var(--border); border-top:4px solid var(--blue); border-radius:50%; width:40px; height:40px; animation:spin 1s linear infinite; }
@keyframes spin{ from{transform:rotate(0)} to{transform:rotate(360deg)} }

/* Modal */
#modal-backdrop{ position:fixed; inset:0; display:none; justify-content:center; align-items:center; z-index:10000; background: rgba(13,17,23,0.35); -webkit-backdrop-filter: blur(14px) saturate(120%); backdrop-filter: blur(14px) saturate(120%); animation:fadeIn .25s ease; }
@keyframes fadeIn{ from{opacity:0} to{opacity:1} }
#modal{ position:relative; width:clamp(280px, 90vw, 520px); max-height:80vh; overflow:auto; padding:22px; border-radius:16px; background: linear-gradient(135deg, var(--modal-tint-strong, rgba(88,166,255,0.20)), transparent 60%), linear-gradient( 45deg, var(--modal-tint-soft, rgba(88,166,255,0.10)), transparent 55%), rgba(22,27,34,0.40); border: 1px solid var(--modal-border, rgba(240,246,252,0.08)); box-shadow:0 10px 30px rgba(0,0,0,.45), inset 0 1px 0 rgba(255,255,255,.03); -webkit-backdrop-filter: blur(6px) saturate(110%); backdrop-filter: blur(6px) saturate(110%); color:var(--text); font-size:14px; animation:slideUp .25s ease; }
@keyframes slideUp{ from{ transform:translateY(10px); opacity:0 } to{ transform:translateY(0); opacity:1 } }
#modal::-webkit-scrollbar{ width:0; height:0 }
#modal{ scrollbar-width:none; -ms-overflow-style:none; overscroll-behavior:contain; }
#modal h2{ margin:0 0 12px; font-weight:600; font-size:18px; color:#f0f6fc; border-bottom:1px solid rgba(240,246,252,0.06); padding-bottom:8px; text-align:left; }
#modal p{ margin:8px 0; line-height:1.6; color:var(--text) }
#modal hr{ border:none; border-top:1px solid rgba(240,246,252,0.06); margin:12px 0; }
#modal table{ width:100%; border-collapse:collapse; margin-top:8px; font-size:13px; }
#modal th, #modal td{ text-align:left; padding:8px 4px; border-bottom:1px solid rgba(240,246,252,0.06); }
#modal th{ color:var(--muted); font-weight:500 }
#modal td{ color:var(--text) }
#modal button.close-btn{ position:absolute; top:10px; right:10px; background:rgba(240,246,252,0.04); border:1px solid rgba(240,246,252,0.08); color:#f0f6fc; font-size:16px; cursor:pointer; font-weight:700; line-height:1; padding:6px 10px; border-radius:10px; transition:transform .12s ease, background-color .15s ease, border-color .15s ease; -webkit-backdrop-filter: blur(2px); backdrop-filter: blur(2px); }
#modal button.close-btn:hover{ background:rgba(240,246,252,0.08); border-color:rgba(240,246,252,0.14); transform:scale(1.03); }
#modal a.link-row{ color:inherit; text-decoration:none; display:inline-flex; align-items:center; gap:8px; padding:2px 6px; border-radius:8px; transition:background-color .15s ease, transform .05s ease; vertical-align:middle; }
#modal a.link-row:hover{ background-color:rgba(240,246,252,0.06); text-decoration:none; }
#modal a.link-row:active{ transform:scale(0.99) }
#modal a.link-row svg{ width:14px; height:14px; display:inline-block; flex:0 0 auto; stroke:currentColor; }

@media (max-width:600px){
  #dropdown-container{ padding:12px; max-width:100% }
  #modal{ width:95%; padding:16px }
  #modal h2{ font-size:16px }
  #modal table{ font-size:12px }
}

/* Progress bar */
.q-linear-progress{ display:flex; align-items:center; gap:8px; padding:4px 6px; border-radius:10px; background:rgba(240,246,252,0.06); border:1px solid rgba(240,246,252,0.10); }
.q-linear-progress__track{ position:relative; flex:1; height:8px; background:rgba(240,246,252,0.08); border:1px solid rgba(240,246,252,0.10); border-radius:999px; overflow:hidden; }
.q-linear-progress__bar{ position:absolute; inset:0 100% 0 0; background:currentColor; transition:width .45s ease; }
.q-linear-progress__label{ font-variant-numeric:tabular-nums; min-width:3ch; text-align:right; }
.line-progress{ display:flex; align-items:center; gap:12px; }
.line-progress .q-linear-progress{ margin-left:auto; min-width:96px; max-width:140px; }
.q-linear-progress--sm{ padding:2px 4px; gap:6px; }
.q-linear-progress--sm .q-linear-progress__track{ height:6px; }
.q-linear-progress--sm .q-linear-progress__label{ font-size:11px; font-weight:500; min-width:2.6ch; opacity:.9; }
@media (min-width: 720px){
  .line-progress .q-linear-progress{ min-width:110px; max-width:130px; }
  .q-linear-progress--sm .q-linear-progress__track{ height:4px; }
}

/* Garante que os textos não bloqueiem o clique no retângulo */
.apt-text, .duracao-text { pointer-events: none; }

/* ========================= */
/* ======= 3D STYLES ======= */
/* ========================= */

/* Canvas 3D em tela cheia abaixo da top bar (top bar fica por cima) */
#app3d{
  position: fixed;
  inset: 0;
  z-index: 0; /* top bar e modal ficam acima */
  background: #0d1117;
}

/* Painel flutuante de UI do 3D */
#ui-3d{
  position: fixed;
  top: 80px;            /* abaixo da top bar (ajuste fino se quiser) */
  right: 16px;
  display: none;        /* controlado via JS */
  flex-direction: column;
  gap: 8px;
  padding: 12px;
  width: min(280px, 90vw);
  background: rgba(22,27,34,0.86);
  border: 1px solid var(--border);
  border-radius: 12px;
  color: var(--text);
  z-index: 1001;        /* acima do canvas e da top bar */
  backdrop-filter: blur(6px);
  -webkit-backdrop-filter: blur(6px);
  box-shadow: 0 8px 24px rgba(0,0,0,0.45);
}

#ui-3d .ui3d-header{
  font-weight: 600;
  margin-bottom: 4px;
  color: #f0f6fc;
}

#ui-3d label{
  font-size: 12px;
  color: var(--muted);
}

/* Controles do 3D (select, sliders, botão) */
#ui-3d select,
#ui-3d button,
#ui-3d input[type="range"]{
  font-family: 'Inter', sans-serif;
}

#ui-3d select{
  background:#21262d;
  color:var(--text);
  border:1px solid var(--border);
  border-radius:10px;
  padding:8px 10px;
  cursor:pointer;
  outline:none;
}
#ui-3d select:focus{
  border-color: var(--blue);
  box-shadow: 0 0 0 3px rgba(88,166,255,.2);
}

/* Slider (range) — simples e compatível */
#ui-3d input[type="range"]{
  -webkit-appearance: none;
  width:100%;
  height: 26px;
  background: transparent;
  cursor: pointer;
}
#ui-3d input[type="range"]::-webkit-slider-runnable-track{
  height: 6px;
  background: #2a2f36;
  border:1px solid var(--border);
  border-radius: 999px;
}
#ui-3d input[type="range"]::-moz-range-track{
  height: 6px;
  background: #2a2f36;
  border:1px solid var(--border);
  border-radius: 999px;
}
#ui-3d input[type="range"]::-webkit-slider-thumb{
  -webkit-appearance: none;
  width: 14px; height: 14px;
  border-radius: 50%;
  background: var(--blue);
  border: 2px solid #1b3b5f;
  margin-top: -5px; /* centraliza no track */
}
#ui-3d input[type="range"]::-moz-range-thumb{
  width: 14px; height: 14px;
  border-radius:50%;
  background: var(--blue);
  border: 2px solid #1b3b5f;
}

/* Botão raio-X */
#ui-3d #xrayBtn-3d{
  background:#21262d;
  color:#f0f6fc;
  border:1px solid var(--border);
  border-radius:10px;
  padding:8px 10px;
  cursor:pointer;
  transition: transform .12s ease, background-color .15s ease, border-color .15s ease, box-shadow .15s ease;
}
#ui-3d #xrayBtn-3d:hover{ filter:brightness(1.05); }
#ui-3d #xrayBtn-3d:active{ transform:scale(0.98); }

/* Responsividade do painel 3D */
@media (max-width: 720px){
  #ui-3d{
    top: 72px;
    right: 12px;
    width: min(320px, 92vw);
    gap: 6px;
    padding: 10px;
  }
  #ui-3d label{ font-size: 11px; }
}
